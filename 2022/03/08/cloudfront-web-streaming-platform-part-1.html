<!DOCTYPE html>
<!--
    Type on Strap jekyll theme v2.4.0
    Theme free for personal and commercial use under the MIT license
    https://github.com/sylhare/Type-on-Strap/blob/master/LICENSE
-->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=0.5, maximum-scale=5">

    
    <!-- Theme Mode -->
    <script>
        const isAutoTheme = true;
        document.documentElement.setAttribute('data-theme', sessionStorage.getItem('theme'))
    </script>
    

    <!-- Main JS (navbar.js, katex_init.js and masonry_init.js)-->
    <script defer src="/assets/js/main.min.js"></script>

    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/main.css">

    <!-- Favicon -->
    <link rel="shortcut icon" href="/assets/favicon.png" type="image/x-icon">

    

    
    <!-- KaTeX 0.15.2 -->
    <script defer src="/assets/js/vendor/katex.min.js"></script>
    <script defer src="/assets/js/vendor/auto-render.min.js" onload="renderMathInElement(document.body);"></script>
    

    
    <!-- Mermaid 8.13.10 -->
    <script defer src="/assets/js/vendor/mermaid.min.js" onload="mermaid.initialize({startOnLoad:true});"></script>
    

    <!-- Simple Jekyll Search 1.9.1 -->
    <script src="/assets/js/vendor/simple-jekyll-search.min.js" type="text/javascript"></script>

    
    <!-- Matomo -->
    <script>
        var _paq = window._paq = window._paq || [];
        /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
        _paq.push(['trackPageView']);
        _paq.push(['enableLinkTracking']);
        (function() {
            var u="https://bedrockstreaming.matomo.cloud/";
            _paq.push(['setTrackerUrl', u+'matomo.php']);
            _paq.push(['setSiteId', '2']);
            var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
            g.async=true; g.src='//cdn.matomo.cloud/bedrockstreaming.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
    </script>
    

    <!-- Google Analytics / Cookie Consent -->
    <script>
      const cookieName = 'cookie-notice-dismissed-https://tech.bedrockstreaming.com';
      const isCookieConsent = 'false';
      const analyticsName = '';
    </script>

    
    

    <!-- SEO tags -->
    <meta property="og:image" content="https://tech.bedrockstreaming.com/images/common/banner_xl.jpg">
    
    <meta property="og:type" content="website" />
    
    <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>How AWS Cloudfront is helping us deliver our Web streaming platform? - Part 1 | Bedrock Tech Blog</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="How AWS Cloudfront is helping us deliver our Web streaming platform? - Part 1" />
<meta name="author" content="Antoine Caron" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="What is a CDN, how is it useful for us? Feedback on the use of the AWS Cloudfront service for the deployment of high traffic web applications. Configuration example, best practices." />
<meta property="og:description" content="What is a CDN, how is it useful for us? Feedback on the use of the AWS Cloudfront service for the deployment of high traffic web applications. Configuration example, best practices." />
<link rel="canonical" href="https://tech.bedrockstreaming.com/2022/03/08/cloudfront-web-streaming-platform-part-1.html" />
<meta property="og:url" content="https://tech.bedrockstreaming.com/2022/03/08/cloudfront-web-streaming-platform-part-1.html" />
<meta property="og:site_name" content="Bedrock Tech Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-03-08T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="How AWS Cloudfront is helping us deliver our Web streaming platform? - Part 1" />
<script type="application/ld+json">
{"description":"What is a CDN, how is it useful for us? Feedback on the use of the AWS Cloudfront service for the deployment of high traffic web applications. Configuration example, best practices.","headline":"How AWS Cloudfront is helping us deliver our Web streaming platform? - Part 1","dateModified":"2022-03-08T00:00:00+00:00","datePublished":"2022-03-08T00:00:00+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://tech.bedrockstreaming.com/2022/03/08/cloudfront-web-streaming-platform-part-1.html"},"url":"https://tech.bedrockstreaming.com/2022/03/08/cloudfront-web-streaming-platform-part-1.html","author":{"@type":"Person","name":"Antoine Caron"},"@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <!-- RSS -->
    <link rel="alternate" type="application/atom+xml" title="Bedrock Tech Blog" href="https://tech.bedrockstreaming.com/feed.xml"/>
    <link type="application/atom+xml" rel="alternate" href="https://tech.bedrockstreaming.com/feed.xml" title="Bedrock Tech Blog" />

    <!-- Twitter Cards -->
    <meta name="twitter:title" content="How AWS Cloudfront is helping us deliver our Web streaming platform? - Part 1">
    <meta name="twitter:description" content="A bit of contextThe web is a major platform for the distribution of our customers’ content at Bedrock.Millions of users connect every month to watch their li...">
    
    <meta name="twitter:card" content="summary">
    <meta name="twitter:image" content="https://tech.bedrockstreaming.com/images/common/banner_xl.jpg">
    <meta name="twitter:image:alt" content="How AWS Cloudfront is helping us deliver our Web streaming platform? - Part 1">
</head>

  <body>
    <header class="site-header">

    <!-- Logo and title -->
	<div class="branding">
        
		<a href="/">
			<img alt="logo img" class="avatar" src="/images/common/br-site-logo.jpg" />
		</a>
        
        <a class="site-title" aria-label="Bedrock Tech Blog" href="/">
        Bedrock Tech Blog
		</a>
	</div>

    <!-- Toggle menu -->
    <nav class="clear">
    <a aria-label="pull" id="pull" class="toggle" href="#">
    <i class="fas fa-bars fa-lg"></i>
    </a>

    <!-- Menu -->
    <ul class="hide">
        

        
            
            
        
            
            
        
            
            <li class="separator"> | </li>
            <li>
                <a class="clear" aria-label="Jobs" title="Jobs" href="/jobs/">
                     Jobs 
                </a>
            </li>
            
            
        
            
            <li class="separator"> | </li>
            <li>
                <a class="clear" aria-label="Last Friday Talks" title="Last Friday Talks" href="/lft/">
                     Last Friday Talks 
                </a>
            </li>
            
            
        
            
            
        
            
            <li class="separator"> | </li>
            <li>
                <a class="clear" aria-label="Meetups & Conferences" title="Meetups & Conferences" href="/meetups/">
                     Meetups & Conferences 
                </a>
            </li>
            
            
        
            
            <li class="separator"> | </li>
            <li>
                <a class="clear" aria-label="OSS" title="OSS" href="/oss/">
                     OSS 
                </a>
            </li>
            
            
        
            
            
        
            
            <li class="separator"> | </li>
            <li>
                <a class="clear" aria-label="Search" title="Search" href="/search/">
                     <i class="fas fa-search" aria-hidden="true"></i>
                    
                </a>
            </li>
            
            
        
            
            <li class="separator"> | </li>
            <li>
                <a class="clear" aria-label="Tags" title="Tags" href="/tags/">
                     <i class="fas fa-tags" aria-hidden="true"></i>
                    
                </a>
            </li>
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
        
        
        <li class="separator"> | </li>
        <li><a id="theme-toggle" title="How AWS Cloudfront is helping us deliver our Web streaming platform? - Part 1 " aria-label="How AWS Cloudfront is helping us deliver our Web streaming platform? - Part 1" onclick="themeToggle()"></a></li>
        
    </ul>

	</nav>
</header>

    <div class="content">
      <article class="feature-image" >
  <header id="main" style="">
    <div class="title-padder">
      
      <h1 id="How+AWS+Cloudfront+is+helping+us+deliver+our+Web+streaming+platform%3F+-+Part%C2%A01" class="title">How AWS Cloudfront is helping us deliver our Web streaming platform? - Part 1</h1>
      <div class="post-info">


<a
      href="https://blog.slashgear.dev/"
      target="_blank"
      rel="noopener"
      class="author">
      <img alt="Author's avatar" src="/images/avatar/a_caron.jpeg" class="thumbnail">
    

    
      <span class="name">
        Antoine Caron
      </span>
    </a><span class="spacer"> - </span>



  <span class="publication-date">
    
    March 08, 2022
  </span>
</div>

      
    </div>
  </header>

  <section class="post-content">
  
      <h2 id="a-bit-of-context">A bit of context</h2>

<p>The web is a major platform for the distribution of our customers’ content at <a href="https://www.bedrockstreaming.com/">Bedrock</a>.
Millions of users connect every month to watch their live, replay or the series and movies of their choice.
The broadcasting of sports events such as the Euro 2020 soccer tournament represents a real technical challenge when it comes to maintaining the stability and performance of such a platform.</p>

<p>The web application works in SSR (Server Side Rendering) mode: we have NodeJS Express servers returning pre-rendered HTML pages.
We made <a href="/2017/05/17/spa-mode-isomorphism-js">this choice several years ago</a>, for two reasons: SEO and to improve the first display time on slow devices.
In addition to the HTML pages, the web platform is also a huge collection of assets that allow the website to function: Javascript bundles, CSS, images, manifests.</p>

<p>Today our customers have users distributed over a large part of the globe.</p>

<p><strong>To meet these challenges, a CDN is a very good solution.</strong></p>

<h2 id="what-is-a-cdn-then-">What is a CDN then ?</h2>

<p>CDN for Content Delivery Network is a service delivering content to users across the internet (here our HTML pages and assets).
Wherever the user is in the world.
To all users, even if they are many.</p>

<p>Cloudfront is the CDN service of AWS.
With a large number of POPs (Point Of Presence) around the world, it helps us provide a response to each user as close as possible to their location.
This allows us to significantly reduce the time to first byte of our responses.
Different <a href="https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/PriceClass.html">price classes</a> allow you to choose the global “area” in which your application should be available in order to achieve savings.</p>

<p><img src="/images/posts/cloudfront-web-streaming-platform/edges.png" alt="Worldmap of AWS cloudfront edges from Cloudfront official documentation" /></p>

<p>Being in Lyon (France), we sometimes get answers from the POP of Milan (Italia).
Indeed, Lyon ↔ Milan is almost as closer as Lyon ↔ Paris.</p>

<p>Note that it is very easy to know which Cloudfront POP answered you.
Each POP is identified by a three letter code that corresponds to the code of the nearest international airport (here: CDG corresponds to Paris Charles de Gaulle airport).</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>x-amz-cf-pop: CDG50-C1
</code></pre></div></div>

<p>Delivering content as close to the user as possible is great, it theoretically reduces waiting time but it does not solve the problem of heavy load.</p>

<p>The best solution for load problems is caching.</p>

<blockquote>
  <p>You put 1 second of cache-control, and you already won!</p>

  <p><a href="https://twitter.com/yverry">Y. Verry, our Head of Infrastructure and Ops</a></p>
</blockquote>

<p>Cloudfront service makes it easy to cache responses at the edge servers.
If we take the example of sports broadcasting, users arrive in large numbers in a very short period of time.
Caching (telling Cloudfront to cache a web page) takes a lot of the load off our Node servers because they are not called.</p>

<p>Caching objects in Cloudfront is also about improving response times.
No need to wait for our servers, the user receives the cached object directly.
Cloudfront even takes advantage of this to apply more powerful compression algorithms like Brotli on these cached objects.
These compressions, performed directly by the CDN, allow you to drastically reduce the size of your objects on the network.
Reducing objects size make our applications load even faster for our users.</p>

<p><strong>Here is our <em>Cache hit ratio</em> in production on 6play.fr website.</strong></p>

<p><img src="/images/posts/cloudfront-web-streaming-platform/cache-hit-ratio.png" alt="cache hit ratio graph showing that we have 99.10% of cache hit rate for our main website" /></p>

<p>Cloudfront also allows us to do “Edge computing”: run code directly in Amazon edges and POPs instead of doing it in our applications.</p>

<p>Lambda at edge (on regional edges servers), Cloudfront function (function that runs on POP servers), Web Application Firewall, here are some very cool features that will allow you to do usual manipulations on your requests/responses.</p>

<p>Finally, by using regional Pop, hundreds of end server edges do not contact your origin (your application) when the cache is invalidated or exceeded.
You can even activate the <a href="https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/origin-shield.html">Origin Shield</a> feature that allows you to further limit the load on your origins.</p>

<p><a href="/images/posts/cloudfront-web-streaming-platform/regional.png"><img src="/images/posts/cloudfront-web-streaming-platform/regional.png" alt="regional edge usage with Cloudfront" /></a></p>

<p>Good per-level cache management even allowed us to completely invalidate the cache of a Cloudfront distribution a few minutes before the start of an event without generating huge traffic on our servers.</p>

<hr />

<p>And that’s it for this first article, in the next part (and normally the last one) you will discover how we have implemented some patterns on our sites.</p>

<p>In the meantime, feel free to have a look at other articles available on this blog:</p>

<ul>
  <li><a href="/2021/11/18/hsdo">More efficient Load Balancing and Caching at AWS, using Consistent Hashing and HAProxy</a></li>
  <li><a href="/2021/12/15/scaling-bedrock-video-delivery-to-50-million-users">Scaling Bedrock video delivery to 50 million users</a></li>
</ul>

    
  </section>

  <!-- Social media shares -->
  

<div class="share-buttons">
    <ul class="share-buttons">
        <li class="meta">Share</li>
         
        <li>
            <a href="https://twitter.com/intent/tweet?text=How+AWS+Cloudfront+is+helping+us+deliver+our+Web+streaming+platform%3F+-+Part%C2%A01%20https%3A%2F%2Ftech.bedrockstreaming.com%2F2022%2F03%2F08%2Fcloudfront-web-streaming-platform-part-1.html"
               target="_blank" title="">
                <i class="fab fa-twitter-square fa-2x" aria-hidden="true"></i>
                <span class="sr-only">Tweet</span>
            </a>
        </li>
             
        <li>
            <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://tech.bedrockstreaming.com/2022/03/08/cloudfront-web-streaming-platform-part-1.html&title=How+AWS+Cloudfront+is+helping+us+deliver+our+Web+streaming+platform%3F+-+Part%C2%A01%20%7C%20Bedrock+Tech+Blog&summary=&source=https://tech.bedrockstreaming.com/2022/03/08/cloudfront-web-streaming-platform-part-1.html"
               target="_blank" title=" LinkedIn">
                <i class="fab fa-linkedin fa-2x" aria-hidden="true"></i>
                <span class="sr-only">Share on LinkedIn</span>
            </a>
        </li>
          
        <li>
            <a href="mailto:?subject=How AWS Cloudfront is helping us deliver our Web streaming platform? - Part 1%20%7C%20Bedrock Tech Blog&body=https://tech.bedrockstreaming.com/2022/03/08/cloudfront-web-streaming-platform-part-1.html"
               target="_blank" title="">
                <i class="fas fa-envelope-square fa-2x" aria-hidden="true"></i>
                <span class="sr-only">Email</span></a>
        </li>
        
    </ul>
</div>




   <!-- Tag list -->
  
  


  <div class="tag-list">
    <ul>
      
        <li class="meta">Tags</li>
      

      
        <li><a class="button" href="/tags/#aws">
          <p><i class="fas fa-tag fa-fw fa-sm"></i> aws</p>
        </a></li>
      
        <li><a class="button" href="/tags/#cdn">
          <p><i class="fas fa-tag fa-fw fa-sm"></i> cdn</p>
        </a></li>
      
        <li><a class="button" href="/tags/#cloudfront">
          <p><i class="fas fa-tag fa-fw fa-sm"></i> cloudfront</p>
        </a></li>
      
        <li><a class="button" href="/tags/#frontend">
          <p><i class="fas fa-tag fa-fw fa-sm"></i> frontend</p>
        </a></li>
      
        <li><a class="button" href="/tags/#javascript">
          <p><i class="fas fa-tag fa-fw fa-sm"></i> javascript</p>
        </a></li>
      
        <li><a class="button" href="/tags/#node.js">
          <p><i class="fas fa-tag fa-fw fa-sm"></i> node.js</p>
        </a></li>
      
        <li><a class="button" href="/tags/#react">
          <p><i class="fas fa-tag fa-fw fa-sm"></i> react</p>
        </a></li>
      
    </ul>
  </div>



</article>

<!-- Post navigation -->

<div id="post-nav">
    
    <div id="previous-post">
        <a alt="Bedrock Dev Facts #16" href="/2022/03/26/bedrock-dev-facts-16.html">
            <p>Previous post</p>
            Bedrock Dev Facts #16
        </a>
    </div>
    

    
    <div id="next-post">
        <a alt="Streaming recommendations at Bedrock" href="/2022/02/27/streaming-recommendation.html">
            <p>Next post</p>
            Streaming recommendations at Bedrock
        </a>
    </div>
    
</div>



<!--Utterances-->


<!-- Cusdis -->


<!-- Disqus -->


<!-- To change color of links in the page -->
<style>
  header#main {
      background-size: cover;
      background-repeat: no-repeat;
      background-position: center;
  }

  
  .post-content a { color: rgb(255,99,71) !important; }
  .share-buttons a { color: rgb(255,99,71) !important; }
  .tag-list a:not(:hover) { color: rgb(255,99,71) !important; }
  div#post-nav a { color: rgb(255,99,71) !important; }
  footer a { color: rgb(255,99,71) !important; }
  .site-header nav a:hover {  color: rgb(255,99,71) !important; }
  a.button:hover {
    background: rgb(255,99,71) !important;
    border: 1px solid rgb(255,99,71) !important;
    color: white;
    text-decoration: none;
    filter: none;
  }
  header#main {
      background-color: rgb(255,99,71) !important;
      background-image: url('/assets/img/lineart.png');
  }
  

  
</style>

    </div>
    <footer class="site-footer">
    <p class="text">
        Powered by <a href="https://jekyllrb.com/">Jekyll</a> with <a href="https://github.com/sylhare/Type-on-Strap">Type on Strap</a>
</p>
            <div class="footer-icons">
                <ul>
                <!-- Social icons from Font Awesome, if enabled -->
                
<li>
    <a feed.xml href="/feed.xml"
       title="Follow RSS feed"
       target="_blank">
        <span class="fa-stack fa-lg">
            <i class="fas fa-circle fa-stack-2x"></i>
            <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
        </span>
    </a>
</li>



    

    

    

    

    

    

    
        
        
        
        
        <li>
            <a href="https://github.com/BedrockStreaming"
               title="Follow on Github"
               target="_blank"
               rel="noopener">
            <span class="fa-stack fa-lg">
              <i class="fas fa-circle fa-stack-2x"></i>
              <i class="fab fa-github fa-stack-1x fa-inverse"></i>
            </span>
            </a>
        </li>
    

    

    

    

    

    

    
        
        
        
        
        <li>
            <a href="https://www.linkedin.com/company/bedrock-streaming"
               title="Follow on Linkedin"
               target="_blank"
               rel="noopener">
            <span class="fa-stack fa-lg">
              <i class="fas fa-circle fa-stack-2x"></i>
              <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
            </span>
            </a>
        </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
        
        
        
        
        <li>
            <a href="https://twitter.com/Bedrock_Tech"
               title="Follow on Twitter"
               target="_blank"
               rel="noopener">
            <span class="fa-stack fa-lg">
              <i class="fas fa-circle fa-stack-2x"></i>
              <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
            </span>
            </a>
        </li>
    

    

    

    

    
        
        
        
        
        <li>
            <a href="https://www.youtube.com/channel/UCSwvTdCWHS6ulRaIqdk7lNw"
               title="Follow on Youtube"
               target="_blank"
               rel="noopener">
            <span class="fa-stack fa-lg">
              <i class="fas fa-circle fa-stack-2x"></i>
              <i class="fab fa-youtube fa-stack-1x fa-inverse"></i>
            </span>
            </a>
        </li>
    


                </ul>
            </div>
</footer>



  </body>
</html>
