<!DOCTYPE html>
<!--
    Type on Strap jekyll theme v2.4.0
    Theme free for personal and commercial use under the MIT license
    https://github.com/sylhare/Type-on-Strap/blob/master/LICENSE
-->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=0.5, maximum-scale=5">

    
    <!-- Theme Mode -->
    <script>
        const isAutoTheme = true;
        document.documentElement.setAttribute('data-theme', sessionStorage.getItem('theme'))
    </script>
    

    <!-- Main JS (navbar.js, katex_init.js and masonry_init.js)-->
    <script defer src="/assets/js/main.min.js"></script>

    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/main.css">

    <!-- Favicon -->
    <link rel="shortcut icon" href="/assets/favicon.png" type="image/x-icon">

    

    
    <!-- KaTeX 0.15.2 -->
    <script defer src="/assets/js/vendor/katex.min.js"></script>
    <script defer src="/assets/js/vendor/auto-render.min.js" onload="renderMathInElement(document.body);"></script>
    

    
    <!-- Mermaid 8.13.10 -->
    <script defer src="/assets/js/vendor/mermaid.min.js" onload="mermaid.initialize({startOnLoad:true});"></script>
    

    <!-- Simple Jekyll Search 1.9.1 -->
    <script src="/assets/js/vendor/simple-jekyll-search.min.js" type="text/javascript"></script>

    
    <!-- Matomo -->
    <script>
        var _paq = window._paq = window._paq || [];
        /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
        _paq.push(['trackPageView']);
        _paq.push(['enableLinkTracking']);
        (function() {
            var u="https://bedrockstreaming.matomo.cloud/";
            _paq.push(['setTrackerUrl', u+'matomo.php']);
            _paq.push(['setSiteId', '2']);
            var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
            g.async=true; g.src='//cdn.matomo.cloud/bedrockstreaming.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
    </script>
    

    <!-- Google Analytics / Cookie Consent -->
    <script>
      const cookieName = 'cookie-notice-dismissed-https://tech.bedrockstreaming.com';
      const isCookieConsent = 'false';
      const analyticsName = '';
    </script>

    
    

    <!-- SEO tags -->
    <meta property="og:image" content="https://tech.bedrockstreaming.com/images/common/banner_xl.jpg">
    
    <meta property="og:type" content="website" />
    
    <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Ce que nous retenons de la droidcon London 2022 | Bedrock Tech Blog</title>
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="Ce que nous retenons de la droidcon London 2022" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Retour sur la virée de Bedrock à la droidcon London 2022, et ce que nous en retenons" />
<meta property="og:description" content="Retour sur la virée de Bedrock à la droidcon London 2022, et ce que nous en retenons" />
<link rel="canonical" href="https://tech.bedrockstreaming.com/2022/11/22/droidcon-london-2022.html" />
<meta property="og:url" content="https://tech.bedrockstreaming.com/2022/11/22/droidcon-london-2022.html" />
<meta property="og:site_name" content="Bedrock Tech Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-11-22T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Ce que nous retenons de la droidcon London 2022" />
<script type="application/ld+json">
{"@type":"BlogPosting","description":"Retour sur la virée de Bedrock à la droidcon London 2022, et ce que nous en retenons","dateModified":"2022-11-22T00:00:00+00:00","datePublished":"2022-11-22T00:00:00+00:00","url":"https://tech.bedrockstreaming.com/2022/11/22/droidcon-london-2022.html","headline":"Ce que nous retenons de la droidcon London 2022","mainEntityOfPage":{"@type":"WebPage","@id":"https://tech.bedrockstreaming.com/2022/11/22/droidcon-london-2022.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <!-- RSS -->
    <link rel="alternate" type="application/atom+xml" title="Bedrock Tech Blog" href="https://tech.bedrockstreaming.com/feed.xml"/>
    <link type="application/atom+xml" rel="alternate" href="https://tech.bedrockstreaming.com/feed.xml" title="Bedrock Tech Blog" />

    <!-- Twitter Cards -->
    <meta name="twitter:title" content="Ce que nous retenons de la droidcon London 2022">
    <meta name="twitter:description" content="La communauté Android a apporté le soleil sur Londres les 27 et 28 octobre 2022. La droidcon London a réuni plus de 1400 développeurs autour de l’écosystème ...">
    
    <meta name="twitter:card" content="summary">
    <meta name="twitter:image" content="https://tech.bedrockstreaming.com/images/common/banner_xl.jpg">
    <meta name="twitter:image:alt" content="Ce que nous retenons de la droidcon London 2022">
</head>

  <body>
    <header class="site-header">

    <!-- Logo and title -->
	<div class="branding">
        
		<a href="/">
			<img alt="logo img" class="avatar" src="/images/common/br-site-logo.jpg" />
		</a>
        
        <a class="site-title" aria-label="Bedrock Tech Blog" href="/">
        Bedrock Tech Blog
		</a>
	</div>

    <!-- Toggle menu -->
    <nav class="clear">
    <a aria-label="pull" id="pull" class="toggle" href="#">
    <i class="fas fa-bars fa-lg"></i>
    </a>

    <!-- Menu -->
    <ul class="hide">
        

        
            
            
        
            
            
        
            
            <li class="separator"> | </li>
            <li>
                <a class="clear" aria-label="Jobs" title="Jobs" href="/jobs/">
                     Jobs 
                </a>
            </li>
            
            
        
            
            <li class="separator"> | </li>
            <li>
                <a class="clear" aria-label="Last Friday Talks" title="Last Friday Talks" href="/lft/">
                     Last Friday Talks 
                </a>
            </li>
            
            
        
            
            
        
            
            <li class="separator"> | </li>
            <li>
                <a class="clear" aria-label="Meetups & Conferences" title="Meetups & Conferences" href="/meetups/">
                     Meetups & Conferences 
                </a>
            </li>
            
            
        
            
            <li class="separator"> | </li>
            <li>
                <a class="clear" aria-label="OSS" title="OSS" href="/oss/">
                     OSS 
                </a>
            </li>
            
            
        
            
            
        
            
            <li class="separator"> | </li>
            <li>
                <a class="clear" aria-label="Search" title="Search" href="/search/">
                     <i class="fas fa-search" aria-hidden="true"></i>
                    
                </a>
            </li>
            
            
        
            
            <li class="separator"> | </li>
            <li>
                <a class="clear" aria-label="Tags" title="Tags" href="/tags/">
                     <i class="fas fa-tags" aria-hidden="true"></i>
                    
                </a>
            </li>
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
        
        
        <li class="separator"> | </li>
        <li><a id="theme-toggle" title="Ce que nous retenons de la droidcon London 2022 " aria-label="Ce que nous retenons de la droidcon London 2022" onclick="themeToggle()"></a></li>
        
    </ul>

	</nav>
</header>

    <div class="content">
      <article class="feature-image" >
  <header id="main" style="">
    <div class="title-padder">
      
      <h1 id="Ce+que+nous+retenons+de+la+droidcon+London+2022" class="title">Ce que nous retenons de la droidcon London 2022</h1>
      <div class="post-info">


<a
      href="https://twitter.com/rafipanoyan"
      target="_blank"
      rel="noopener"
      class="author">

    
      <span class="name">
        Rafi Panoyan
      </span>
    </a><span class="spacer"> - </span>



<span class="author">

    
      <span class="name">
        David Yim
      </span>
    </span><span class="spacer"> - </span>



<span class="author">

    
      <span class="name">
        Damien Cuny
      </span>
    </span><span class="spacer"> - </span>



  <span class="publication-date">
    
    November 22, 2022
  </span>
</div>

      
    </div>
  </header>

  <section class="post-content">
  
      <p>La communauté Android a apporté le soleil sur Londres les 27 et 28 octobre 2022. La droidcon London a réuni plus de 1400 développeurs autour de l’écosystème Android, de ses outils et enjeux actuels. Jetpack Compose, évidemment, mais aussi Gradle, modularisation, optimisation et autres sujets plus divers ont été abordés lors de ce rendez-vous incontournable pour la communauté.</p>

<p><img src="/images/posts/2022-11-22-droidcon-london/entrance.jpg" alt="droidcon London 2022 entrance" /></p>

<ul id="markdown-toc">
  <li><a href="#ça-compile----rafi-panoyan" id="markdown-toc-ça-compile----rafi-panoyan">Ça compile ? - Rafi Panoyan</a>    <ul>
      <li><a href="#vous-reprendrez-bien-un-peu-de-gradle-enterprise-" id="markdown-toc-vous-reprendrez-bien-un-peu-de-gradle-enterprise-">Vous reprendrez bien un peu de Gradle Enterprise ?</a></li>
      <li><a href="#dessine-moi-un-module" id="markdown-toc-dessine-moi-un-module"><em>Dessine-moi un module</em></a></li>
      <li><a href="#trucs-et-astuces" id="markdown-toc-trucs-et-astuces">Trucs et astuces</a></li>
    </ul>
  </li>
  <li><a href="#design-the-world---damien-cuny" id="markdown-toc-design-the-world---damien-cuny">Design the world - Damien Cuny</a>    <ul>
      <li><a href="#to-compose" id="markdown-toc-to-compose">To Compose</a></li>
      <li><a href="#design-system" id="markdown-toc-design-system">Design System</a></li>
      <li><a href="#vers-linfini-et-au-delà" id="markdown-toc-vers-linfini-et-au-delà">Vers l’infini et au-delà</a></li>
    </ul>
  </li>
  <li><a href="#la-gestion-des-erreurs---david-yim" id="markdown-toc-la-gestion-des-erreurs---david-yim"><strong>La gestion des erreurs</strong> - David Yim</a>    <ul>
      <li><a href="#vérification-des-entrées" id="markdown-toc-vérification-des-entrées">Vérification des entrées</a></li>
      <li><a href="#le-type-either" id="markdown-toc-le-type-either">Le type Either</a></li>
      <li><a href="#kotlin-result" id="markdown-toc-kotlin-result">Kotlin Result</a></li>
      <li><a href="#conclusion" id="markdown-toc-conclusion">Conclusion</a></li>
    </ul>
  </li>
  <li><a href="#à-la-prochaine-" id="markdown-toc-à-la-prochaine-">À la prochaine !</a></li>
</ul>

<h2 id="ça-compile----rafi-panoyan">Ça compile ? - Rafi Panoyan</h2>

<p>Les sujets de compilation ont tenu une place très importante lors de cette édition de la droidcon Londres 2022. 
Qu’il s’agisse d’optimiser ses temps de compilation, de repenser la création de modules et des dépendances entre eux, de factoriser les logiques des scripts de compilation, 
nous avons eu une emphase claire sur l’importance d’adresser ces sujets.</p>

<h3 id="vous-reprendrez-bien-un-peu-de-gradle-enterprise-">Vous reprendrez bien un peu de Gradle Enterprise ?</h3>

<p><a href="https://twitter.com/nellyspageli">Nelson Osacky</a>, qui travaille chez Gradle, a présenté tous les outils que la formule <a href="https://gradle.com/">Gradle Entreprise</a> met à disposition des développeurs pour analyser en détail les compilations.</p>

<p>Vous voulez vérifier que la compilation incrémentale est bien appliquée partout où cela est possible ? Un script permet de comparer, dans des conditions reproductibles, 
les entrées et sorties de vos builds, et analyse les tâches empêchant ce mécanisme central dans la réduction des temps de compilation.</p>

<p>Vous voulez vous assurer que Gradle est bien capable de retrouver le cache de vos tâches sur un même poste ou bien depuis le cloud ? 
Là aussi des outils vous permettent d’identifier précisemment les points qui ne tirent pas parti de ces mécanismes.</p>

<p>On regrettera que ces outils soient disponibles uniquement pour la formule payante de Gradle. Cependant, les <a href="https://scans.gradle.com/">scans Gradle</a> sont, eux,
gratuits et illimités, et permettent tout de même de mesurer et comparer des compilations et ainsi suivre l’impact des différentes optimisations que vous pourriez apporter.</p>

<h3 id="dessine-moi-un-module"><em>Dessine-moi un module</em></h3>

<p>La modularisation ayant un impact sur les temps de compilation, plusieurs conférences ont abordé ce sujet très en vogue dans la communauté Android.</p>

<p>Un point de vue intéressant de <a href="https://twitter.com/josef_raska">Josef Raska</a> nous invite à nous poser la question de la pertinence de modulariser selon le contexte. 
Ne pas suivre une tendance mais se poser la question de l’utilité d’un nouveau module, et encore plus de ses dépendances avec les autres modules. 
Voilà des propos qui invitent à mesurer concrètement l’impact du chantier de la modularisation dans nos applications.</p>

<p>Ainsi, si on peut penser que modulariser permet de réduire les temps de compilation (en tirant parti de la parallélisation des tâches par exemple), 
un chemin de dépendances trop long entre le module initial et la dépendance la plus profonde va entraîner une augmentation du temps de compilation.</p>

<p>Vigilance, donc, sur les “hubs de dépendances” (ces dépendances dont beaucoup de modules ont besoin, et qui ont besoin de beaucoup de modules).</p>

<figure>
  <img src="/images/posts/2022-11-22-droidcon-london/dep-hub.png" alt="Dependency hub" />
  <figcaption>1. Hub de dépendances</figcaption>
</figure>
<hr />

<p>De la même manière, un chemin de dépendances de trop grande profondeur ne permettra pas de tirer parti de la parallélisation des tâches de compilation.
Sur le schéma ci-dessous, on peut voir qu’un chemin de profondeur 4 existe pour aller du module applicatif vers le module le plus bas dans la hiérarchie.</p>

<figure>
  <img src="/images/posts/2022-11-22-droidcon-london/dep-height.png" alt="Dependency height" />
  <figcaption>2. Profondeur de dépendances</figcaption>
</figure>
<hr />

<p>Josef Raska propose le schéma suivant avec un découpage API/implémentation afin de réduire au maximum cette profondeur, et ainsi compiler plus rapidement.</p>

<figure>
  <img src="/images/posts/2022-11-22-droidcon-london/dep-height-fix.png" alt="Dependency height fix" />
  <figcaption>3. Profondeur de dépendances réduite</figcaption>
</figure>
<hr />

<p>Android Studio et son analyse de dépendances peut être très utile pour vérifier et mesurer cela.
Josef Raska a d’ailleurs créé un plugin Gradle afin de spécifier ces règles à l’echelle d’un projet et de s’assurer qu’elles soient respectées : <a href="https://github.com/jraska/modules-graph-assert">modules-graph-assert</a>.</p>

<h3 id="trucs-et-astuces">Trucs et astuces</h3>

<p>Après ces conseils très avisés mais structurellement chronophages à mettre en place (surtout sur de gros projets déjà créés), d’autres conférenciers se sont plutôt tournés vers les “quick-win”. Des changements peu coûteux, aux gains plus modestes mais qui s’additionnent, il en existe quelques-uns.</p>

<p>Ainsi, si Gradle nous permet d’activer des fonctionnalités de caching (<code class="language-plaintext highlighter-rouge">org.gradle.unsafe.configuration-cache=true</code> pour gagner du temps lors de la phase de configuration par exemple), il est aussi possible de désactiver des fonctionnalités du plugin Android si elles ne nous sont pas utiles.</p>

<p>Voici une petite liste des propriétés qui sont activées par défaut, même lorsqu’elles ne sont pas utilisées dans les modules :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>android {
  buildFeatures {
    buildConfig false
    aidl false
    renderScript false
    resValues false
    shaders false
  }
}
</code></pre></div></div>

<p>Si vous n’utilisez pas les valeurs liées à la configuration de votre compilation, ne générez pas de <code class="language-plaintext highlighter-rouge">BuildConfig</code>.
Si vous n’avez pas de resources dans votre module, désactivez la génération de <code class="language-plaintext highlighter-rouge">resValue</code> !</p>

<p>Retrouvez ici la liste de ces fonctionnalités, leur utilité et leurs valeurs par défaut : <a href="https://developer.android.com/reference/tools/gradle-api/4.1/com/android/build/api/dsl/BuildFeatures">BuildFeatures</a>.</p>

<h2 id="design-the-world---damien-cuny">Design the world - Damien Cuny</h2>

<p>Il y a un peu plus d’un an sortait la version 1.0 de <a href="https://developer.android.com/jetpack/compose">Jetpack Compose</a>, le nouveau toolkit déclaratif pour la création d’interfaces Android. D’autre part, le design system <a href="https://m3.material.io/">Material Design 3</a> vient de sortir en version stable et son implémentation <a href="https://developer.android.com/jetpack/androidx/releases/compose-material">Compose Material</a> sont également disponibles.<br />
Avec tout cela, le design a, cette année encore, tenu une place de choix dans l’agenda de cette droidcon 2022 à Londres.<br />
Mais comment utiliser tout cela correctement ? Comment s’en servir pour implémenter un design system personnalisé ? Jusqu’où peut-on aller ?
Autant de questions auxquelles ont tenté de répondre les nombreuses présentations sur le sujet.</p>

<h3 id="to-compose">To Compose</h3>

<p>Compose facilite beaucoup de choses dans l’implémentation et le maintien d’interfaces sur Android. Cependant, cela nécessite de réapprendre à faire certaines choses que l’on maîtrise déjà avec le système de <a href="https://developer.android.com/reference/android/view/View"><code class="language-plaintext highlighter-rouge">View</code></a>.<br />
Dessiner dans un canvas en est une, et <a href="https://twitter.com/hi_man_shoe">Himanshu Singh</a> dans sa présentation <em>“Composing in your canvas”</em>, nous montre les pièges à éviter pour réaliser cela avec Compose.</p>

<p>La recomposition peut également être source de problèmes et de latences si Compose est mal utilisé. Dans sa présentation <em>“Understanding recomposition performance pitfalls”</em>, <a href="https://twitter.com/jossiwolf">Jossi Wolf</a> et <a href="https://twitter.com/shikasd_">Andrei Shikov</a> nous donnent, à partir d’un exemple concret, les meilleures astuces pour l’utiliser à bon escient.</p>

<h3 id="design-system">Design System</h3>

<p>En faisant le parallèle avec la saga épique de JRR Tolkien, <a href="https://medium.com/@danielbbeleza">Daniel Beleza</a>, dans sa présentation <em>“One design system to rule them all”</em>, nous explique comment il a réussi, tout en se passant de <a href="https://material.io">Material design</a>, à unifier et automatiser son propre design system.<br />
Cela demande, évidemment, une collaboration totale de la part de l’équipe de design, mais une fois cette intégration faite, les bénéfices et l’autonomie se ressentent de part et d’autre.<br />
Des outils tel que <a href="https://www.figma.com/">Figma</a>, <a href="https://square.github.io/kotlinpoet/">Kotlin Poet</a> ou des plugins Android Studio custom lui ont permis d’automatiser ensuite ce processus.</p>

<p>Material Design est un design system. Il a l’avantage d’être bien documenté, uniforme et régulièrement enrichi. De plus, il est déjà implémenté dans l’ancien système de View Android et plus récemment dans Jetpack Compose avec <a href="https://developer.android.com/jetpack/androidx/releases/compose-material">Compose Material</a>.</p>

<p>Une des différences majeures entre Compose et le système de View sur Android est son découpage. Dans Compose, Material n’est implémenté et n’apparaît que dans la partie la plus hautes alors que dans le système de View, son implémentation est répartie dans toutes les couches de la librairie.<br />
Il est donc assez complexe de se passer de Material avec le système de View mais cela est complétement envisageable, voire recommandé, dans certains cas avec Compose.</p>

<p><img src="/images/posts/2022-11-22-droidcon-london/views-vs-compose.png" alt="Views VS Compose" /></p>

<p>Pour illustrer cela <a href="https://twitter.com/seebrock3r">Sebastiano Poggi</a> (la moitié de <a href="https://www.youtube.com/c/CodewiththeItalians">Coding with the italians</a>) est venu nous présenter, dans <em>“Compose beyond Material”</em>, les questions à se poser avant de se lancer dans son design system et comment le package <a href="https://developer.android.com/jetpack/androidx/releases/compose-foundation">Foundation</a> de Compose peut nous aider.</p>

<p>Pour terminer il nous donne de nombreux conseils concrets sur l’implémentation de composants sans Material. Le principal, rejoint la présentation d’introduction de cette droidcon, <em>“The Silver Bullet Syndrome Director’s Cut - Complexity Strikes Back!”</em>, un bon design system est un design system qui correspond à nos besoins et qui y répond le plus simplement possible.</p>

<h3 id="vers-linfini-et-au-delà">Vers l’infini et au-delà</h3>

<p><a href="https://twitter.com/chrisbanes">Chris Bane</a> et <a href="https://twitter.com/mrmans0n">Nacho Lopez</a> dans leur présentation <em>“Branching out Jetpack Compose”</em>, nous ont raconté comment l’aventure du passage à Compose s’est déroulée chez Twitter, une des premières apps à l’adopter.<br />
Avec une code base aussi conséquente (plus de <strong>1000 modules</strong>, dont 300 pour le design, répartis sur plus de 30 équipes), ils ont dû progressivement convaincre les équipes, les former et les accompagner.<br />
La question de continuer à utiliser Material Design s’est également posée chez eux. Ils l’ont dans un premier temps conservé pour faciliter le passage sur Compose, pour finalement le retirer complètement en se basant, eux aussi, sur le package Foundation.<br />
Leur présentation résume bien l’ensemble des étapes et des questions par lesquelles ils sont passés pour accomplir cette transition.</p>

<p>Afin de remettre les choses en perspective, <a href="https://twitter.com/askashdavies">Ash Davies</a> nous rappelle que Compose est un simple pattern de développement multiplateforme. De ce fait, il peux être appliqué à autre chose qu’à de l’UI comme le propose Jetpack Compose. Il nous explique dans <em>“Demystifying Molecule: Running Your Own Compositions For Fun And Profit”</em>, comment l’appliquer à la couche domaine d’un projet pour le “Fun”.</p>

<h2 id="la-gestion-des-erreurs---david-yim"><strong>La gestion des erreurs</strong> - David Yim</h2>

<p>La gestion des erreurs a été le sujet de plusieurs présentations à la droidcon. Ces présentations avaient pour objectif de servir de piqûre de rappel sur l’importance de bien prendre en compte ce problème concernant tous les développeurs. Aujourd’hui, nous avons tous les outils pour gérer facilement nos erreurs. Cependant, par paresse et comme nous préférons penser de manière positive, nous ne pensons souvent qu’aux cas de succès et les cas d’erreurs sont souvent brouillons voire ne sont même pas spécifiés.</p>

<p>Les speakers m’ont marqué avec un exemple de mauvaise gestion d’erreur qui a coûté plusieurs centaines de milliers de dollars. L’exemple parlait d’une faille sur le site japonais de 7-Eleven, une chaîne de supérettes, dont elle a été victime. Dans la base de données de ce projet, les développeurs ont ajouté un champ “date de naissance” comme nullable. Plus tard, ce champ est devenu non-nullable. Par paresse, le développeur qui a rendu ce champ non-nullable a mis par défaut un 1er janvier 2019 sur cette date lorsqu’elle n’était pas renseignée, simplement pour satisfaire son compilateur. Le problème est que ce champ fut plus tard utilisé dans la fonctionnalité de mot de passe oublié du site. En utilisant la date par défaut du 1er janvier 2019, un hacker a pu récupérer des comptes utilisateurs et voler des informations bancaires. Cet exemple m’a marqué par l’habitude que nous avons en tant que développeur de nous soucier que de satisfaire notre compilateur plutôt que de vraiment discuter de solutions réfléchies à nos problèmes techniques.</p>

<p>Plusieurs méthodes de gestion des erreurs existent et les speakers en ont présentés quelques-unes.</p>

<h4 id="vérification-des-entrées">Vérification des entrées</h4>

<p>L’une des méthode pour être certain de ne pas avoir de problème est de vérifier les données que l’on reçoit. Prenons un exemple simple :</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">data class</span> <span class="nc">User</span><span class="p">(</span><span class="kd">val</span> <span class="py">email</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span>
</code></pre></div></div>

<p>Rien n’empêche d’instancier cette classe de la manière suivante :</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">val</span> <span class="py">user</span> <span class="p">=</span> <span class="nc">User</span><span class="p">(</span><span class="n">email</span> <span class="p">=</span> <span class="s">""</span><span class="p">)</span>
</code></pre></div></div>

<p>Cela peut créer des problèmes par le futur, alors qu’il y a un moyen d’éviter cela</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">Email</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">value</span><span class="p">:</span> <span class="nc">String</span> <span class="p">=</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">value</span><span class="p">.</span><span class="nf">isEmpty</span><span class="p">()</span> <span class="p">||</span> <span class="p">!</span><span class="nc">Regex</span><span class="p">(</span><span class="nc">EMAIL_FORMAT</span><span class="p">).</span><span class="nf">matches</span><span class="p">(</span><span class="n">value</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="nc">Exception</span><span class="p">(</span><span class="s">"Email format is not correct"</span><span class="p">)</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">value</span>
        <span class="p">}</span>
<span class="p">}</span>

<span class="kd">data class</span> <span class="nc">User</span><span class="p">(</span><span class="k">private</span> <span class="kd">val</span> <span class="py">email</span><span class="p">:</span> <span class="nc">Email</span><span class="p">)</span>
</code></pre></div></div>

<p>Cette méthode peut paraître un peu exagérée dans cet exemple. Mais dans un contexte où la classe <code class="language-plaintext highlighter-rouge">User</code> serait utilisée par un grand nombre d’équipes et que les règles métier de l’<code class="language-plaintext highlighter-rouge">Email</code> serait complexe, cette méthode prendrait tout son sens pour éviter d’avoir de mauvaises surprises !</p>

<h4 id="le-type-either">Le type Either</h4>

<p>Le type <code class="language-plaintext highlighter-rouge">Either</code> est un moyen de différencier les cas de succès des cas d’erreurs. Il est disponible dans la <a href="https://arrow-kt.io/">librairie Arrow</a> ou facilement reproduisible :</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">sealed</span> <span class="kd">class</span> <span class="nc">Either</span><span class="p">&lt;</span><span class="k">out</span> <span class="nc">A</span><span class="p">,</span> <span class="k">out</span> <span class="nc">B</span><span class="p">&gt;</span> <span class="p">{</span>
    <span class="kd">class</span> <span class="nc">Left</span><span class="p">&lt;</span><span class="nc">A</span><span class="p">&gt;(</span><span class="kd">val</span> <span class="py">value</span><span class="p">:</span> <span class="nc">A</span><span class="p">):</span> <span class="nc">Either</span><span class="p">&lt;</span><span class="nc">A</span><span class="p">,</span> <span class="nc">Nothing</span><span class="p">&gt;()</span>
    <span class="kd">class</span> <span class="nc">Right</span><span class="p">&lt;</span><span class="nc">B</span><span class="p">&gt;(</span><span class="kd">val</span> <span class="py">value</span><span class="p">:</span> <span class="nc">B</span><span class="p">):</span> <span class="nc">Either</span><span class="p">&lt;</span><span class="nc">Nothing</span><span class="p">,</span> <span class="nc">B</span><span class="p">&gt;()</span>
<span class="p">}</span>
</code></pre></div></div>

<p>L’utilisation de ce type est qu’il est soit un type <code class="language-plaintext highlighter-rouge">A</code>, soit un type <code class="language-plaintext highlighter-rouge">B</code>. On peut ainsi définir par exemple que le <code class="language-plaintext highlighter-rouge">A</code> est un cas de succès et que le type <code class="language-plaintext highlighter-rouge">B</code> est un cas d’erreur.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">data class</span> <span class="nc">User</span><span class="p">(</span><span class="kd">val</span> <span class="py">name</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span>

<span class="kd">var</span> <span class="py">either</span><span class="p">:</span> <span class="nc">Either</span><span class="p">&lt;</span><span class="nc">User</span><span class="p">,</span> <span class="nc">Exception</span><span class="p">&gt;</span>

<span class="k">when</span> <span class="p">(</span><span class="n">either</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">is</span> <span class="nc">Either</span><span class="p">.</span><span class="nc">Left</span> <span class="p">-&gt;</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"The user is called ${(either as Either.Left&lt;User&gt;).value.name}"</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">is</span> <span class="nc">Either</span><span class="p">.</span><span class="nc">Right</span> <span class="p">-&gt;</span> <span class="p">{</span>
        <span class="p">(</span><span class="n">either</span> <span class="k">as</span> <span class="nc">Either</span><span class="p">.</span><span class="nc">Right</span><span class="p">&lt;</span><span class="nc">Exception</span><span class="p">&gt;).</span><span class="n">value</span><span class="p">.</span><span class="nf">printStackTrace</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Grâce à ce type, on peut par exemple savoir si un appel à une API a réussi ou non, ce qui nous permet de gérer plus facilement nos cas d’erreurs.</p>

<h4 id="kotlin-result">Kotlin Result</h4>

<p>La classe <code class="language-plaintext highlighter-rouge">Result</code> est similaire au type <code class="language-plaintext highlighter-rouge">Either</code> et a pour avantage d’être directement inclue dans Kotlin et que l’on n’a pas à se synchroniser pour savoir si le côté gauche est le cas de succès ou d’erreur.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">data class</span> <span class="nc">User</span><span class="p">(</span><span class="kd">val</span> <span class="py">name</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span>

<span class="kd">var</span> <span class="py">result</span><span class="p">:</span> <span class="nc">Result</span><span class="p">&lt;</span><span class="nc">User</span><span class="p">&gt;</span>

<span class="k">when</span> <span class="p">{</span>
    <span class="n">result</span><span class="p">.</span><span class="n">isSuccess</span> <span class="p">-&gt;</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"The user is called ${result.getOrNull()?.name}"</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="n">result</span><span class="p">.</span><span class="n">isFailure</span> <span class="p">-&gt;</span> <span class="p">{</span>
        <span class="n">result</span><span class="p">.</span><span class="nf">exceptionOrNull</span><span class="p">()</span><span class="o">?.</span><span class="nf">printStackTrace</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nc">OU</span>

<span class="n">result</span><span class="p">.</span><span class="nf">onSuccess</span> <span class="p">{</span> <span class="n">user</span> <span class="p">-&gt;</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"The user is called ${user.name}"</span><span class="p">)</span>
<span class="p">}.</span><span class="nf">onFailure</span> <span class="p">{</span> <span class="n">throwable</span> <span class="p">-&gt;</span>
    <span class="n">throwable</span><span class="p">.</span><span class="nf">printStackTrace</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="conclusion">Conclusion</h3>

<p>Plusieurs méthodes existent pour prendre en compte nos cas d’erreurs. Laquelle est la meilleure ? Eh bien vous vous y attendez sûrement, mais ça dépend ! On choisira une méthode ou une autre selon ce qui nous arrange par rapport à la situation, nos choix d’outils techniques ou nos effectifs. L’important étant de prendre en compte ces cas d’erreurs et de ne pas laisser leur résolution au hasard. Les cas d’erreurs ne sont en fait que d’autres usecases de l’utilisateur et souvent ne sont pas des edgecase. Ils méritent donc d’être tout autant réfléchis et spécifiés que les cas de succès !</p>

<h2 id="à-la-prochaine-">À la prochaine !</h2>

<p>Il est toujours intéressant de mesurer l’engouement pour tel ou tel sujet dans la communauté Android en analysant les présentations lors des différentes conférences technologiques.</p>

<p>Sans aucun doute, cette droidcon était sous le signe de Jetpack Compose, qui bénéficie d’un suivi et d’un engagement fort de Google et de toute la communauté.<br />
Tout l’enjeu ici est de rester au contact des innovations et de l’évolution de la plateforme Android, et Jetpack Compose offre un défi que nous avons commencé à relever chez Bedrock.</p>

<p>Nous attendons avec impatience de voir où va Android, et avons à coeur de participer à cette aventure qui nous lie tous !</p>

<p><img src="/images/posts/2022-11-22-droidcon-london/hall.jpg" alt="Hall droidcon London 2022" /></p>

    
  </section>

  <!-- Social media shares -->
  

<div class="share-buttons">
    <ul class="share-buttons">
        <li class="meta">Share</li>
         
        <li>
            <a href="https://twitter.com/intent/tweet?text=Ce+que+nous+retenons+de+la+droidcon+London+2022%20https%3A%2F%2Ftech.bedrockstreaming.com%2F2022%2F11%2F22%2Fdroidcon-london-2022.html"
               target="_blank" title="">
                <i class="fab fa-twitter-square fa-2x" aria-hidden="true"></i>
                <span class="sr-only">Tweet</span>
            </a>
        </li>
             
        <li>
            <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://tech.bedrockstreaming.com/2022/11/22/droidcon-london-2022.html&title=Ce+que+nous+retenons+de+la+droidcon+London+2022%20%7C%20Bedrock+Tech+Blog&summary=&source=https://tech.bedrockstreaming.com/2022/11/22/droidcon-london-2022.html"
               target="_blank" title=" LinkedIn">
                <i class="fab fa-linkedin fa-2x" aria-hidden="true"></i>
                <span class="sr-only">Share on LinkedIn</span>
            </a>
        </li>
          
        <li>
            <a href="mailto:?subject=Ce que nous retenons de la droidcon London 2022%20%7C%20Bedrock Tech Blog&body=https://tech.bedrockstreaming.com/2022/11/22/droidcon-london-2022.html"
               target="_blank" title="">
                <i class="fas fa-envelope-square fa-2x" aria-hidden="true"></i>
                <span class="sr-only">Email</span></a>
        </li>
        
    </ul>
</div>




   <!-- Tag list -->
  
  


  <div class="tag-list">
    <ul>
      
        <li class="meta">Tags</li>
      

      
        <li><a class="button" href="/tags/#android">
          <p><i class="fas fa-tag fa-fw fa-sm"></i> android</p>
        </a></li>
      
        <li><a class="button" href="/tags/#conference">
          <p><i class="fas fa-tag fa-fw fa-sm"></i> conference</p>
        </a></li>
      
        <li><a class="button" href="/tags/#droidcon">
          <p><i class="fas fa-tag fa-fw fa-sm"></i> droidcon</p>
        </a></li>
      
    </ul>
  </div>



</article>

<!-- Post navigation -->

<div id="post-nav">
    
    <div id="previous-post">
        <a alt="How many DynamoDB RCU and WCU should we reserve to achieve maximum cost reductions, when our workloads are changing all the time?" href="/2022/11/22/dynamodb-reservations.html">
            <p>Previous post</p>
            How many DynamoDB RCU and WCU should we reserve to achieve maximum cost reductions, when our workloads are changing all the time?
        </a>
    </div>
    

    
    <div id="next-post">
        <a alt="Ce que nous avons retenu de la SymfonyCon - Disneyland Paris 2022" href="/2022/11/17/symfonycon.html">
            <p>Next post</p>
            Ce que nous avons retenu de la SymfonyCon - Disneyland Paris 2022
        </a>
    </div>
    
</div>



<!--Utterances-->


<!-- Cusdis -->


<!-- Disqus -->


<!-- To change color of links in the page -->
<style>
  header#main {
      background-size: cover;
      background-repeat: no-repeat;
      background-position: center;
  }

  
  .post-content a { color: rgb(251,87,66) !important; }
  .share-buttons a { color: rgb(251,87,66) !important; }
  .tag-list a:not(:hover) { color: rgb(251,87,66) !important; }
  div#post-nav a { color: rgb(251,87,66) !important; }
  footer a { color: rgb(251,87,66) !important; }
  .site-header nav a:hover {  color: rgb(251,87,66) !important; }
  a.button:hover {
    background: rgb(251,87,66) !important;
    border: 1px solid rgb(251,87,66) !important;
    color: white;
    text-decoration: none;
    filter: none;
  }
  header#main {
      background-color: rgb(251,87,66) !important;
      background-image: url('/assets/img/lineart.png');
  }
  

  
</style>

    </div>
    <footer class="site-footer">
    <p class="text">
        Powered by <a href="https://jekyllrb.com/">Jekyll</a> with <a href="https://github.com/sylhare/Type-on-Strap">Type on Strap</a>
</p>
            <div class="footer-icons">
                <ul>
                <!-- Social icons from Font Awesome, if enabled -->
                
<li>
    <a feed.xml href="/feed.xml"
       title="Follow RSS feed"
       target="_blank">
        <span class="fa-stack fa-lg">
            <i class="fas fa-circle fa-stack-2x"></i>
            <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
        </span>
    </a>
</li>



    

    

    

    

    

    

    
        
        
        
        
        <li>
            <a href="https://github.com/BedrockStreaming"
               title="Follow on Github"
               target="_blank"
               rel="noopener">
            <span class="fa-stack fa-lg">
              <i class="fas fa-circle fa-stack-2x"></i>
              <i class="fab fa-github fa-stack-1x fa-inverse"></i>
            </span>
            </a>
        </li>
    

    

    

    

    

    

    
        
        
        
        
        <li>
            <a href="https://www.linkedin.com/company/bedrock-streaming"
               title="Follow on Linkedin"
               target="_blank"
               rel="noopener">
            <span class="fa-stack fa-lg">
              <i class="fas fa-circle fa-stack-2x"></i>
              <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
            </span>
            </a>
        </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
        
        
        
        
        <li>
            <a href="https://twitter.com/Bedrock_Tech"
               title="Follow on Twitter"
               target="_blank"
               rel="noopener">
            <span class="fa-stack fa-lg">
              <i class="fas fa-circle fa-stack-2x"></i>
              <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
            </span>
            </a>
        </li>
    

    

    

    

    
        
        
        
        
        <li>
            <a href="https://www.youtube.com/channel/UCSwvTdCWHS6ulRaIqdk7lNw"
               title="Follow on Youtube"
               target="_blank"
               rel="noopener">
            <span class="fa-stack fa-lg">
              <i class="fas fa-circle fa-stack-2x"></i>
              <i class="fab fa-youtube fa-stack-1x fa-inverse"></i>
            </span>
            </a>
        </li>
    


                </ul>
            </div>
</footer>



  </body>
</html>
