---
layout: post
title: "Babitch, the story behind our table soccer web application"
description: "Babitch, the story behind our table soccer/foosball web application"
author:
  name:           M6Web
  avatar:         m6web.jpg
  email:
  twitter:  techm6web
  facebook:
  github: M6Web
category:
tags: [opensource, babyfoot]
image:
  feature: posts/babitch/tablesoccer.jpg
  credit: Japrisner @ Flickr
  creditlink: http://www.flickr.com/photos/58141828@N05/5362632590/sizes/m/in/photolist-9aSTQA-aaApJn-7XhiQ1-9mm8iR-aDDtjQ-9x39H5-dUWFva-9W6hXa-bfbkqp-dtY159-8vS35Z-ctJMJY-9hvrus-7EBXJJ-8hZDrs-8ECAcX-8EFKL9-bceqjn-8erzXx-8hy4fP-bvuRWY-8BhKgz-8vV58N-9dMBVt-9W97P9-9ciEma-7Riztb-7Cr2Y8-88bzzS-bBZoUQ-dVoiY4-ds7Tb4-8EvLBp-8HMkVg-8HMkXF-8HQtR9-8HQu1j-8HQtNN-8HQu6w-8HMm88-8HQtVd-dUg7yj-9QddPr-9eb3WU-8HQtXU-dLHHqu-dLCauB-ds8cwQ-ds8fvG-89CvbS-ds82e4/
comments: true
---

At M6Web, we love playing foosball !.
We have one old (incredibly strong) soccer table in our « fun room », and at lunch time, a part of us, enjoying playing it in a 2 vs 2 way.

The soccer table in enterprise is awesome for a lot of things :

* Team building between each players
* Don’t think about work (almost) when we are playing
* Fun ! a lot of !
* …

So, as programmers, we tend to have software ideas for each questions in our life ! and the questions we had with foosball was :

* Who is the best player ?
* How many goals i did
* Who won most games ?
* …

So, we begin to talk several month ago about a foosball apps, allowing us to record each games, and each goals, to compute lot of stats about our games.
Everyone had good ideas about it, but someone have many more than us. Even more that it ruins all motivation of the other folks wanting to do work on this webapps, because the firsts step to begin the apps with all the features we have in mind was too big for all of us …

So before having start the project, it was over !

Few month later, an other part of the team, began in a « ghost » way to develop the most simple stupid foosball application. it just allow to select 4 players, and to do match by telling who score and what kind of goal (normal or own goal).
This was ugly as possible, but it works ! and was an awesome start for improving it and give back all motivation developpers had loosing before !

Babitch was born :)

# Architecture

At the beggining, there was only one project, with the server Api, and the client part.
This was bad. It was a good way to start fast, but a bad way to allow each project to evolve in his own side.
So we decided to divide the Babitch Project into two parts, Babitch, the server Api, and BabitchClient, a client to consume Babitch Api data.

# Babitch, the Api

The "Babitch" Api, is a simple PHP/MySQL project, based on Symfony2, FosRestBundle, and NelmioApiDocBundle.
The documentation generated by the NelmioApiDocBundle is available on /api/doc and allows to view each Route of the API, and with the Sandbox menu, to send requests on them.
The API is functionnaly tested by Behat.
A Vagrant file is available if you want to try it easily. (More information in the Readme.md)

# Babitch Client

The "Babitch Client", is the "official" client for the Api.
The client side doesn't require any webserver, it's just an Angular.js apps, doing Rest queries to the Babitch API, thanks to Restangular.

We Use Yeoman to bootstrap the project because it helps in many ways :

* Add grunt configuration and support for serving / building and testing the project
* have generators for controllers / service etc

For development on this client, we are heavily using Grunt, Karma for Unit Testing, and the new Protactor for E2E testing.


The client is divided into four major parts :

## New Game

This is the main feature, it allows to begin a new game, choose 4 players, and assign each goals to the right players.
The game is saved only when the last goals is made.
Each player is represented by is Gravatar for a nicer UI :)

## Live

The table soccer is not at the same stage than we are, so we are using our monitoring screen, to show at lunch time, the live state of the table score !
With a screen on this feature, we could see :

* if a game is played right now
* who played
* The live score
* for each goal, in live, who score, and on which side :)

The live part use a Faye server, which you can host freely on Heroku (more information on Readme.md). You configure a channel name, and all actions done on the new game view are forwarded to the Faye server, forwarded back to the client listening on the Live view. It just rocks !

## Stats

All of this would be useless if you don't have any way to compare your ... stats to others competitors, right ?
So stats section is here for that purpose.
It show you :

* the last match played
* a table sortable for each stats of each players
* an individual card by players
* a table sortable for each stats of each teams

And for each players and teams, you have access to a lot of stats :

* Percentage of goals per balls played
* Percentage of victory/loose per game
* Number of Gameplayed
* Team Goalaverage
* ...

There was some long debate about how stats has to be computed : On the server side ? (not really the goal of a REST Api ...), on the client side ?
After some successfull tries, we decide to compute stats on the client side, in an Angular.Js Service.
The service load the last 300 games, and compute team and player stats fastly.

## Admin

Probably the first screen you will need, for a simple way to add, modify, or delete players.

# Conclusion

Working on our free (or lunch) time on a side-project like this is awesome !
It allows us to use several technologies or tools we don't use often, to improve our knowledge on tons of other things, and to mix teams who don't work a lot together.

One other thing interested to remember about that project : Keep things as simple & small as possible (according to KISS principles) ! And only when your simple project is done, iterate by adding more & more features.
